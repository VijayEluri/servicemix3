<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!-- START SNIPPET: jndi -->
<beans>

  <import resource="tx.xml" />
  <import resource="security.xml" />

  <bean id="jndi" 
        class="org.apache.xbean.spring.jndi.SpringInitialContextFactory" 
        factory-method="makeInitialContext"
        singleton="true">
    <property name="entries">
      <map>
      
        <!-- PXE DB datasource -->
        <!--
        <entry key="java:comp/env/jdbc/pxe__pm">
          <bean class="org.hsqldb.jdbc.jdbcDataSource">
            <property name="database" value="jdbc:hsqldb:mem:pxe"/>
            <property name="user" value = "sa"/>
            <property name="password" value = ""/>
          </bean>
        </entry>
        -->
        
        <!-- wsn2005 jms connection factory -->
        <entry key="java:comp/env/jms/wsnotificationCF">
          <bean class="org.apache.activemq.ActiveMQConnectionFactory">
            <property name="brokerURL" value="tcp://localhost:61616" />
          </bean>
        </entry>

        <!-- transaction manager -->
        <entry key="javax.transaction.TransactionManager" value-ref="transactionManager" />
        <entry key="java:comp/env/smx/TransactionManager" value-ref="transactionManager" />
        
        <!-- bootstrap context -->
        <entry key="java:comp/env/smx/BootstrapContext" value-ref="bootstrapContext" />
        
        <!-- connection context -->
        <entry key="java:comp/env/smx/ConnectionManager" value-ref="connectionManager" />
        
        <!-- Authentication service -->
        <entry key="java:comp/env/smx/AuthenticationService" value-ref="authenticationService" />
        
        <!-- Keystore manager -->
        <entry key="java:comp/env/smx/KeystoreManager" value-ref="keystoreManager" />
      </map>
    </property>
  </bean>

  <!-- A managed JDBC DataSource for derby -->
  <!-- needs tranql derby
  <bean id="localDerbyMCF" class="org.tranql.connector.derby.EmbeddedXAMCF">
    <property name="databaseName" value="data/derby"/>
    <property name="createDatabase" value="true"/>
  </bean>
  <bean id="localDerbyDataSource" class="org.springframework.jca.support.LocalConnectionFactoryBean">
    <property name="managedConnectionFactory" ref="localDerbyMCF"/>
    <property name="connectionManager" ref="connectionManager"/>
  </bean>
  -->
  
  <!-- A managed JMS ConnectionFactory for ActiveMQ -->
  <bean id="activemqMCF" class="org.apache.activemq.ra.ActiveMQManagedConnectionFactory">
    <property name="resourceAdapter">
      <bean class="org.apache.activemq.ra.ActiveMQResourceAdapter">
        <property name="serverUrl" value="vm://localhost"/>
      </bean>
    </property>
  </bean>
  <bean id="activemqCF" class="org.springframework.jca.support.LocalConnectionFactoryBean">
    <property name="managedConnectionFactory" ref="activemqMCF"/>
    <property name="connectionManager" ref="connectionManager"/>
  </bean>
        
</beans>
<!-- END SNIPPET: jndi -->
