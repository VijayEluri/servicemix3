/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


                      Apache ServiceMix 3.2.2
                      =======================

See the README file for more general informations about ServiceMix.


ServiceMix URLs:
----------------
Home Page:     http://servicemix.apache.org/
Downloads:     http://servicemix.apache.org/download.html
Documentation: http://servicemix.apache.org/documentation.html
Mailing Lists: http://servicemix.apache.org/mailing-lists.html
Source Code:   http://servicemix.apache.org/source.html
Bug Tracking:  http://issues.apache.org/activemq/browse/SM

Changes:
--------

Bug

    * [SM-607] - Files dropped into the install directory sometimes result in a "file in use by another process" error
    * [SM-1111] - Endpoint operation information lost when routing through camel
    * [SM-1136] - PreDestroy being called for each exchange when it's not configured that way.
    * [SM-1157] - maven-jbi-plugin creates wrong classpath entries in jbi.xml for SE
    * [SM-1158] - Cxf BC provider should handle soap message correctly when soap message has empty soap header
    * [SM-1159] - Cxf bc provider should check MessageExchange status before send out the message to avoid "Out not supported" exception.
    * [SM-1161] - jbi-service-unit causes infinite loop when dependency graph is not cycle-free
    * [SM-1163] - CXF SE missing type attribute in jbi outbound message
    * [SM-1170] - Geronimo deployer and plugin build failures
    * [SM-1171] - BeanEndpoint can receive messages before it has fully started, causing exceptions
    * [SM-1172] - namespace prefix missing from jbi mesage to soap message
    * [SM-1175] - spring-jmx is dependent on spring-aop and needs included in the servicemix/lib directory
    * [SM-1184] - Data loss due to random exceptions in a saxon service unit
    * [SM-1186] - NormalizedMessageImpl.getAttachment() returns DataHandler when it should return null
    * [SM-1189] - Race condintion in Auto Deployer
    * [SM-1191] - Couldn't deploy >1 separate servicemix-camel service-units
    * [SM-1193] - Cxf Se endpoint should support the interfaceName is null in the incoming exchange
    * [SM-1196] - XmlSchema version upgrade required for CXF components
    * [SM-1197] - Archetype itests failing
    * [SM-1198] - servicemix-jms unit tests are hanging
    * [SM-1199] - Current release of ServiceMix 3.2.1 (as per 2008/01/20) still required MyBootstrap class for a ServiceEngine
    * [SM-1200] - Problems using document('') inside xslt, depending on the source type
    * [SM-1201] - Move mock classes from servicemix-soap2 subproject to a better location
    * [SM-1203] - Rollback does not work when using XA
    * [SM-1209] - JmsConsumerEndpoint doesn't shut down the Spring AbstractMessageListenerContainer properly
    * [SM-1210] - provide locationURI attribute for cxfbc:consumer endpoint so that customer can specify the address which will override the one in wsdl.
    * [SM-1214] - Sitemesh TLD contains illegal short-name in web-console
    * [SM-1216] - NoClassDefFoundError: org/aopalliance/intercept/MethodInvocation
    * [SM-1217] - Deployment fails with ZipException
    * [SM-1219] - camel pipeline does not copy over properties
    * [SM-1220] - MTOM not returning attachments from NormalizedMessages
    * [SM-1224] - Maven archetype plugin unable to locate servicemix-* archetypes
    * [SM-1225] - cxf bc provider should support exchange without specifing the operationName if portType only have one operation
    * [SM-1228] - MTomCheckInterceptor force attachment writing even if there are no attachments
    * [SM-1232] - Mtom not working correctly with cxf-bc provider
    * [SM-1240] - jbi:embeddedServicemix goal does not wait forever anymore
    * [SM-1243] - servicemix-cxf-se proxy can not be used without the #context attribute
    * [SM-1251] - CXF BC provider doesn't produce WS-Addressing Headers
    * [SM-1252] - CXF BC provider doesn't detect automatically the SOAP version of the message to send
    * [SM-1254] - Possible memory leak when the jms consumer can not send the response back to the broker
    * [SM-1259] - Error in CxfBc WrapperOutInterceptor - uses the location in the iterator.
    * [SM-1260] - CXFBC doesn't support multiple parts defined in wsdl.
    * [SM-1262] - SMX 3.2 org.apache.servicemix.lwcontainer.LwContainerComponentTest fails if the maven repository location is non-default.
    * [SM-1263] - LwContainerComponentTest fails on windows on the 3.2.2 branch
    * [SM-1265] - Truncation of SM_STORE.ID field by eip component when using a jdbcStore
    * [SM-1267] - maven-jbi-plugin refuses to include jbi-component jars into SE packages
    * [SM-1268] - ServiceMix 3.2.2 servicemix-cxf-se /CxfSeSpringTest failing due to recent changes to the component.
    * [SM-1272] - cocurrency problem in cxf bc provider
    * [SM-1273] - Add repository entry for java.net dependencies
    * [SM-1274] - Deployables should build before archetypes
    * [SM-1275] - SMX parent pom do not have maven-checkstyle-plugin version locked so picking up checkstyle 4.3 version gives some checkstyle errors.
    * [SM-1276] - ServiceMix 3.2 deployables/serviceengines/servicemix-lwcontainer had test dependency on servicemix-quartz but SMX-quartz get build later than lwcontainer component.
    * [SM-1278] - While using DefaultMessageListenerContainer transactions are not properly rolled back
    * [SM-1280] - FTP poller stalls because the connection pool is empty
    * [SM-1281] - Preserving or configuring content-type of http-header
    * [SM-1283] - SMX 3.2 deployables should build serviceengines before bindingcomponents to avoid servicemix-cxf-bc test failure on clean repo.
    * [SM-1286] - Saxon does not resolve xsl imports / includes relative to the location
    * [SM-1287] - <drools:namespace-context /> element does not work anymore
    * [SM-1288] - <http:consumer/> endpoints do not work when used with another web server than jetty
    * [SM-1294] - Null MessageExchange parameter passed to sendError() method after HttpConsumerEndpoint timeout
    * [SM-1301] - should use getDefaultBus api but not create bus explicitly
    * [SM-1303] - generate endpoint description for cxf se endpoint so that we can see the wsdl from webconsole when deploy into tomcat
    * [SM-1304] - Servicemix-cxf-bc provider fails to send a correct soap msg when useJBIWrapper=false
    * [SM-1309] - SmxHttpExchange: Method intended to override HttpExchange not named correctly
    * [SM-1312] - build broken for servicemix-wsn2005 module
    * [SM-1318] - cxf bc provider should load transport according to endpoint from wsdl but not hardcoded
    * [SM-1325] - README update for the servicemix-web sample
    * [SM-1328] - cxf bc provider should support unqualified fault defined in the wsdl
    * [SM-1331] - cxf-bc provider not handling soap headers correctly
    * [SM-1334] - oneway invocation exception with cxfbc jms transport
    * [SM-1340] - using servicemix-cxf-bc to proxy extenal web service,return the message which lost 'xsd' and 'xsi' namespace
    * [SM-1343] - camel component lost the property which was set in the JBI endpoint
    * [SM-1344] - NPE in servicemix-http ws-security when not configuring the keystore
    * [SM-1349] - SimpleFlatFileMarshaler runs out of memory on big files
    * [SM-1351] - Cxf Bc should transform import xsd to inline xsd for endpoint's definition
    * [SM-1352] - content based router does not work anymore because of wrong evaluate mode
    * [SM-1353] - Problem with CXF SE component after stop and restart
    * [SM-1356] - cxf-bc tests failing due to CxfBcProvider schema import handling throws null pointer exception.
    * [SM-1357] - EL in web console are not evaluated in WebSphere 6.1
    * [SM-1365] - OSWorkflow tests using example file which includes wrong dtd version
    * [SM-1368] - Bug with backslashes in SMX 3.2.2-SNAPSHOT under Windows
    * [SM-1369] - all modules in servicemix build failed when generate checkstyle report since it expect a LICENSE file in current folder
    * [SM-1373] - Camel component does not forward out message correctly when used in a pipeline
    * [SM-1377] - servicemix-file endpoint error
    * [SM-1382] - Camel cannot change JbiExchange's out message when JBI InOnly MessageExchange was initially received
    * [SM-1393] - ServiceMix client does not send the DONE status when using the request() method
    * [SM-1394] - CxfBcRMSequenceTest intermittent failures on windows.
    * [SM-1397] - Explicitly specifying a MEP on a JBI endpoint should override the Camel Exchange's MEP
    * [SM-1407] - Memory Leak in http consumer processor when a timeout occurs
    * [SM-1419] - cxf bc provider should load cxf bus interceptor configuration as well
    * [SM-1420] - Some servicemix pom refer to repo.mergere.com which is not online so needs to be changed to repo1.maven.org
    * [SM-1425] - Property 'property' not found when xmlns="http://www.springframework.org/schema/beans" is defined
    * [SM-1426] - HTTP Provider does not return any JBI response (out/fault/error message) when get a "Connection refused:" from remote http endpoint
    * [SM-1427] - Soap marshalers can not be overriden
    * [SM-1430] - Incoming attachments not processed in CxfBcProviderMessageObserver.
    * [SM-1431] - CXF (se proxy) routing issues with same servicenames
    * [SM-1434] - servicemix-jms does not honor jms 1.02 when sending the out message as a consumer
    * [SM-1443] - The servicemix-binding-component archetype test named MySpringComponentTest is missing a public constructor
    * [SM-1464] - The 'rescheduleTimeouts' property of the SplitAggregator does not work
    * [SM-1471] - cxf bc provider should handle response message with security soap header correctly
    * [SM-1472] - servicemix-archetypes-itests tests failed

Improvement

    * [SM-1112] - Add a way to access the Delivery Channel inside the ScriptExchangeHelper to create new Message Exchanges etc.
    * [SM-1115] - FilePoller should offer configurable targetOperation
    * [SM-1123] - Namespace support for the xpath parameter annotation.
    * [SM-1130] - FtpPoller should offer configurable targetOperation
    * [SM-1155] - New component: OSWorkflow JBI Component
    * [SM-1174] - update cxf version used in servicemix
    * [SM-1218] - ServiceMix logging refers to the incubator website
    * [SM-1222] - FilePoller and FileSender archetypes
    * [SM-1233] - add jms transport support for cxf-bc
    * [SM-1236] - CXF BC should be able to manage WSA Headers as a Map of Strings
    * [SM-1253] - checkstyle error in servicemix-osworkflow
    * [SM-1255] - Ability to not check duplicate files when uploading
    * [SM-1256] - exclusion axiom-impl dependency for woden in servicemix-soap2
    * [SM-1261] - Allow script component to send InOut exchanges as a consumer
    * [SM-1264] - Cleanup the servicemix-binding-component archetype so the BCs it creates pass the Checkstyle rules
    * [SM-1271] - Make ComponentContext available to beans configured in BeanComponent service unit xbean.xml
    * [SM-1284] - should avoid using hardcode lib version of ws-notification sample
    * [SM-1313] - cxf bc provider should add SoapActionOutInterceptor by default
    * [SM-1315] - Enhance logging inside TraceComponent.java to log NormalizedMassage properties
    * [SM-1319] - always use LogUtils.getL7dLogger to get Logger which support pluggable log frame work from cxf
    * [SM-1320] - Add the maven-remote-resources-plugin to the build to automatically produce NOTICE, LICENSE and DEPENDENCIES files
    * [SM-1322] - switch to using the finer grained Spring jars
    * [SM-1333] - Support custom line separator for SimpleFlatFileMarshaler
    * [SM-1336] - CXF-SE should convert outbound DataHandlers into JBI Attachments
    * [SM-1338] - cxf bc consumer should use NormalizedMessage but not NormalizedMessageImpl
    * [SM-1341] - remove org.apache.servicemix.jbi.messaging.NormalizedMessageImpl dependency for servicemix-cxf-se to make it runable on servicemix4 jbi layer
    * [SM-1348] - Add support for mapping between JBI NormalizedMessage attachments and Camel Message attachments
    * [SM-1355] - XML escaping converter for SimpleFlatFileMarshaler
    * [SM-1358] - JAXPXPathExpression subclass returning any kind of object not only String
    * [SM-1359] - Increase the default size of the thread pool
    * [SM-1364] - allow SimpleFlatFileMarshaler to use XmlEscapingCoverter
    * [SM-1367] - Provide logging statements when doing authorization in SMX
    * [SM-1372] - support exception check for cxf bc provider outgoing chain
    * [SM-1379] - CXF BC provider should support dynamic HTTP location URI
    * [SM-1402] - Cleaning up the ServiceMix-Camel component pom
    * [SM-1403] - Clean up the ServiceMix example of Camel
    * [SM-1408] - Add a timeout on the http endpoint for both consumer and provider sides
    * [SM-1415] - Allow specifying an encoding on the DefaultFileMarshaler
    * [SM-1450] - Allow the jetty client thread pool size to be configurable
    * [SM-1452] - remove camel-itests from camel example in kit
    * [SM-1463] - ship commons-lang and commons-io in kit since they are used by servicemix-core

New Feature

    * [SM-971] - SU archetype for servicemix-drools
    * [SM-1096] - File-based message auditor
    * [SM-1226] - Validation component should optionally handle errors by propagating a "correct JBI message" with "fault content"
    * [SM-1239] - EIP StaticRecipientList should propagate properties in asynchronous exchanges
    * [SM-1277] - New archetype: Top-level pom.xml with SA project
    * [SM-1361] - cxf bc should delegate ws-security to jaas
    * [SM-1380] - maven archetype to support wsdl-first development with servicemix-cxf-se
    * [SM-1400] - cxf bc consumer should be able to retrieve wsdl from internal endpoint of JBI bus if there is one

Task

    * [SM-992] - Fix XSD schema locations for use with plain spring

Test

    * [SM-1308] - CxfBcProviderSecurityTest test failed
    * [SM-1321] - test to demostrate how to configure to support jaxws dispatch provider
    * [SM-1342] - CxfBcAddressingTest failed caused by cxf recent change
    * [SM-1370] - CxfBcProviderSecurityTest failed caused by the certificate we use for this test expired
    * [SM-1384] - CxfBcProviderTest from deployables/bindingcomponents/servicemix-cxf-bc fails due to unexpected availability of the service.
    * [SM-1409] - Modifications to ServiceMix cxf-bc ws-rm test and servicemix-wsn serviceengine.
    * [SM-1413] - test to verify both send and sendSync can work with cxf bc provider using jms transport identically



